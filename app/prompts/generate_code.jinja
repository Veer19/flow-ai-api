{# prompts/generate_code.jinja #}

Write a Python function using pandas to answer the following query:

ğŸ§  Query:
{{ query }}

ğŸ” Operations:
{% for operation in operations %}
- {{ operation }}
{% endfor %}

ï¿½ğŸ“‚ Required datasets:
{% for dataset in datasets %}
ğŸ“ Dataset {{ loop.index }}:
- ID: {{ dataset['id'] }}
- Name: {{ dataset['filename'] }} ({{ dataset['rows'] }} rows, {{ dataset['columns'] }} columns)
- Columns:
  {% for col in dataset['columnMetadata'] %}
    - {{ col['name'] }} ({{ col['type'] }})
  {% endfor %}
- Sample row:
  {{ dataset['sampleData'][0] | tojson }}
{% endfor %}

---

The function should:
1. Accept a `dfs` dictionary containing the loaded DataFrames
2. Perform the necessary analysis
3. Return the result as a JSON-compatible object
4. Include relevant keys that describe the result
5. MAKE SURE the returned result can be converted to a JSON object
6. Always keep the returned result in a dictionary format
7. If you are retunring a list, return it as a list of dictionaries

ğŸ”§ Format:
```python
def analyze_data(dfs):
    # Your analysis code here
    result = ...
    return result

ğŸš« Do not include explanations, comments, or markdown outside the function. Only return the function code block.
