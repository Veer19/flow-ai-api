Re‑phrased query (from planner):
{{ query }}

Planned pandas operations:
{% for op in operations %}
- {{ op }}
{% endfor %}

{% for dataset in datasets %}
📁 Dataset {{ loop.index }}:
- ID: {{ dataset['id'] }}
- Name: {{ dataset['filename'] }} ({{ dataset['rows'] }} rows, {{ dataset['columns'] }} columns)
- Columns:
  {% for col in dataset['columnMetadata'] %}
    - {{ col['name'] }} ({{ col['type'] }})
  {% endfor %}
- Sample Row:
  {{ dataset['sampleData'][0] | tojson }}
{% endfor %}
