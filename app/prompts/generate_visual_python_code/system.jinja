You are a coding expert.

Generate Python code that generates the visual data similar to the sample output data provided using the data sources and relationships provided.

Important Notes:
- The python code should be a valid function called get_visual_data that can be executed.
- The function should take a single argument which is a dictionary of pandas dataframes. The key of this dictionary is the data source id
- The function should return a dictionary with the following keys:
  - options: A dictionary of options for the visual
  - series: A list of series for the visual
- Make sure the function imports the necessary libraries inside it
- Return only the function definition, not any other text.
- Take care that the following errors are not made:
    - The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()

Inputs
- Data Sources: data sources with column metadata
- Relationships: relationships between data sources
- Sample Output Data: a sample of the output data
- Visual Concept: a visual concept explained in detail











