{"query": "Give me my top 5 and bottom 5 customers", "result": {"type": "analysis", "message": "Your top 5 customers by quantity purchased are Euro Shopping Channel, Mini Gifts Distributors Ltd., Australian Collectors, Co., La Rochelle Gifts, and AV Stores, Co. The bottom 5 customers by quantity purchased are Cambridge Collectables Co., Auto-Moto Classics Inc., Royale Belge, Atelier graphique, and Boards & Toys Co.", "data": {"bottom_5_customers": [{"QUANTITY": 357, "SOLD_TO": "Cambridge Collectables Co."}, {"QUANTITY": 287, "SOLD_TO": "Auto-Moto Classics Inc."}, {"QUANTITY": 278, "SOLD_TO": "Royale Belge"}, {"QUANTITY": 270, "SOLD_TO": "Atelier graphique"}, {"QUANTITY": 102, "SOLD_TO": "Boards & Toys Co."}], "top_5_customers": [{"QUANTITY": 9327, "SOLD_TO": "Euro Shopping Channel"}, {"QUANTITY": 6366, "SOLD_TO": "Mini Gifts Distributors Ltd."}, {"QUANTITY": 1926, "SOLD_TO": "Australian Collectors, Co."}, {"QUANTITY": 1832, "SOLD_TO": "La Rochelle Gifts"}, {"QUANTITY": 1778, "SOLD_TO": "AV Stores, Co."}]}, "attach": "inline_table"}, "code_generated": "def analyze_data(datasets: dict):\n    import pandas as pd\n    if \"sales.csv\" not in datasets:\n        return {\"error\": \"Missing required dataset sales.csv\"}\n    sales = datasets[\"sales.csv\"]\n    grouped = sales.groupby(\"SOLD_TO\", as_index=False)[\"QUANTITY\"].sum()\n    sorted_desc = grouped.sort_values(\"QUANTITY\", ascending=False).reset_index(drop=True)\n    top5 = sorted_desc.head(5)\n    bottom5 = sorted_desc.tail(5)\n    result = {\n        \"top_5_customers\": top5.to_dict(orient=\"records\"),\n        \"bottom_5_customers\": bottom5.to_dict(orient=\"records\")\n    }\n    return result"}